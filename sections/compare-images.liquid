<div class="advanced-filtration section {{ section.settings.ctm_cls }}">
  <div class="container">
    <div class="section_header text-center ms-0 m-md-auto">
      {% if section.settings.heading != blank %}
        <h2 class="title-lg">
          {{ section.settings.heading }}
        </h2>
      {% endif %}
      {% if section.settings.sub_text != blank %}
        {{ section.settings.sub_text }}
      {% endif %}
    </div>
    <div class="mw-970">
      <div class="row gy-3">
        {% for block in section.blocks %}
          {% case block.type %}
            {% when 'icon_box' %}
              <div class="col-md-{{ block.settings.sepration }}">
                <div class="filter_benefit text-center">
                  {% if block.settings.icon != blank %}
                    <img
                      src="{{ block.settings.icon | img_url: '36x' }}"
                      alt="{{ block.settings.icon.alt }}"
                      class="pb-md-3"
                    >
                  {% endif %}
                  <div class="text-md-center text-start">
                    {% if block.settings.i_head != blank %}
                      <h6>{{ block.settings.i_head }}</h6>
                    {% endif %}
                    {% if block.settings.t_text != blank %}
                      <p>{{ block.settings.t_text }}</p>
                    {% endif %}
                  </div>
                </div>
              </div>
          {% endcase %}
        {% endfor %}
      </div>
    </div>
    <div class="filter_comparsion section">
      <div class="row align-items-center gy-3">
        <div class="col-md-6">
          {% for block in section.blocks %}
            {% if block.type == 'column' %}
              <div class="comparsion">
                <div class="comparsion_inner" data-block-id="{{ block.id }}">
                  <div class="image-container">
                    {% if block.settings.image_1 != blank %}
                      <img
                        class="image-before slider-image"
                        src="{{ block.settings.image_1 | img_url: '' }}"
                        alt="color photo"
                      >
                    {% endif %}
                    {% if block.settings.image_2 != blank %}
                      <img
                        class="image-after slider-image"
                        src="{{ block.settings.image_2 | img_url: '' }}"
                        alt="black and white"
                      >
                    {% endif %}
                  </div>
                  <input
                    type="range"
                    min="0"
                    max="100"
                    value="50"
                    aria-label="Percentage of before photo shown"
                    class="slider"
                    data-block-id="{{ block.id }}"
                  >
                  <div class="slider-line" aria-hidden="true"></div>
                  <div class="slider-button" aria-hidden="true">
                    <img src="{{ 'slider_arrows.svg' | asset_url }}" alt="">
                  </div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
        <div class="col-md-6">
          <div class="row gy-3">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'benefit' %}
                  <div class="col-12 {% if forloop.last %}pb-0{% else %}pb-1{% endif %}">
                    <div class="row align-items-center">
                      <div class="col-md-4 col-6">
                        <div class="filter_info">
                          <h5 class="mb-0">{{ forloop.index }}</h5>
                          {% if block.settings.benefit_head != blank %}
                            <p>{{ block.settings.benefit_head }}</p>
                          {% endif %}
                        </div>
                      </div>
                      {% if block.settings.benefit_text != blank %}
                        <div class="col-md-8 col-6">
                          <p>{{ block.settings.benefit_text }}</p>
                        </div>
                      {% endif %}
                    </div>
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Select all slider elements
  document.querySelectorAll('.slider').forEach(slider => {
    slider.addEventListener('input', (e) => {
      const blockId = e.target.getAttribute('data-block-id');
      const container = document.querySelector(`.comparsion_inner[data-block-id="${blockId}"]`);
      
      if (container) {
        container.style.setProperty('--position', `${e.target.value}%`);
      }
    });
  });
</script>
{% schema %}
{
  "name": "t:sections.image_comapre.label",
  "settings": [
    {
      "type": "text",
      "id": "ctm_cls",
      "label": "t:common.classname.custom"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "t:common.heading.label"
    },
    {
      "type": "richtext",
      "id": "sub_text",
      "label": "t:common.text.label"
    }
  ],
  "blocks": [
    {
      "type": "icon_box",
      "name": "t:common.text_icon.text_icon",
      "limit": 4,
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "t:common.icon.label"
        },
        {
          "type": "text",
          "id": "i_head",
          "label": "t:common.heading.label"
        },
        {
          "type": "textarea",
          "id": "t_text",
          "label": "t:common.text.label"
        },
        {
          "type": "range",
          "id": "sepration",
          "label": "t:progressBlock.column.partition",
          "max": 6,
          "min": 2,
          "step": 1,
          "default": 4
        }
      ]
    },
    {
      "type": "column",
      "name": "t:sections.compare-box.name",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image_1",
          "label": "t:common.image.first"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "t:common.image.second"
        }
      ]
    },
    {
      "type": "benefit",
      "name": "t:product.benefits.title",
      "settings": [
        {
          "type": "text",
          "id": "benefit_head",
          "label": "t:common.heading.label"
        },
        {
          "type": "textarea",
          "id": "benefit_text",
          "label": "t:common.text.content"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.image_comapre.label",
      "settings": {
        "heading": "4-Stage Advanced Filtration Technology",
        "sub_text": "<p>Qure’s Faucet Filter uses an advanced carbon filter – the preferred and most effective method.<\/p>"
      },
      "blocks": [
        {
          "type": "benefit",
          "settings": {
            "benefit_head": "Carbon filter",
            "benefit_text": "Removes up to 99.9% chlorine & contaminants"
          }
        },
        {
          "type": "benefit",
          "settings": {
            "benefit_head": "Ultra filter",
            "benefit_text": "Reduces tiny particles"
          }
        },
        {
          "type": "benefit",
          "settings": {
            "benefit_head": "Descaler",
            "benefit_text": "Reduces limescale buildup"
          }
        },
        {
          "type": "benefit",
          "settings": {
            "benefit_head": "Reduction layer",
            "benefit_text": "Reduces heavy metals"
          }
        },
        {
          "type": "icon_box",
          "settings": {
            "icon": "shopify:\/\/shop_images\/descaling.svg",
            "i_head": "ASP (descaling)",
            "t_text": "Reduces limescale buildup, which, when left untreated, can dry out your skin.",
            "sepration": 4
          }
        },
        {
          "type": "icon_box",
          "settings": {
            "icon": "shopify:\/\/shop_images\/metal.svg",
            "i_head": "Heavy metal reduction layer",
            "t_text": "Targets heavy metals like lead.",
            "sepration": 4
          }
        },
        {
          "type": "icon_box",
          "settings": {
            "icon": "shopify:\/\/shop_images\/Ultrafilter.svg",
            "i_head": "Ultrafilter",
            "t_text": "A very fine filter (down to 0.01 microns), it removes tiny particles like sand and bacteria.",
            "sepration": 4
          }
        },
        {
          "type": "column",
          "settings": {
            "image_1": "shopify:\/\/shop_images\/other-water-filter.webp",
            "image_2": "shopify:\/\/shop_images\/qure-faucet-filter.webp"
          }
        }
      ]
    }
  ]
}
{% endschema %}
