<!-- -- black friday bundle start -- -->
<div class="bf_bundle_sale" id="bf-bundles">
    <div class="container">
        <div class="section_header mw-100">
            <div class="bfs_reviews d-flex align-items-center gap-2 justify-content-center mb-2">
                <img src="https://qureskincaredns.com/new/assets/bfs_reviews.webp" alt="" class="img-fluid">
                <p><strong>5000+ customers</strong> recently purchased a bundle</p>
            </div>
            {%- for block in section.blocks -%}
                {% if block.type == 'badge' %}
                    <div class="bfs_tag mt-3 mb-md-2 mx-auto">
                        <p class="bfs_tag_bf">{{ block.settings.heading }}</p>
                        <p class="bfs_tag_sale" style="background-color: {{ block.settings.color }}">{{ block.settings.text }}</p>
                    </div>
                {% endif %}
            {% endfor %}
            <div class="bf-bundles_title text-center mb-2 mb-md-3">
                {% if section.settings.heading != blank %}
                    <h3>{{ section.settings.heading }}</h3>
                {% endif %}
                {% if section.settings.subheading != blank %}
                    <h4>{{ section.settings.subheading }}</h4>
                {% endif %}
            </div>
        </div>
        <div class="mw-600 mx-auto pb-md-3">
            {% if section.settings.text != blank %}
                <div class="light_green_tag">
                    {{ section.settings.text }}
                </div>    
            {% endif %}
            <div class="bf_bundle_sale_ftr">
                {%- for block in section.blocks -%}
                    {% if block.type == 'object' %}
                        <a href="{{ block.settings.link_url }}" class="bf_bundle_sale_ftr_item">
                            {% if block.settings.image != blank %}
                                <div class="new_img">
                                    <img src="{{ block.settings.image | img_url: '250x' }}" alt="{{ block.settings.image.alt | escape }}" class="img-fluid">
                                </div>
                            {% endif %}
                            {{ block.settings.text |  replace: '\n', '<br />' }}
                        </a>
                    {% endif %}
                {%- endfor -%}
            </div>
        </div>
    </div>
</div>
<!-- -- black friday bundle end -- -->

<style>
    .soldout {
        --bgPercent:100% !important;
    }
    .soldout .stock_left {
        display: none !important;
    }
    .soldout .me-1 {
        display: none !important;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.type_radio').forEach(radio => {
            radio.addEventListener('click', function() {
                let variantId = 0;
                const parentDiv = this.closest('.bfs_bf_item');
                const button = parentDiv ? parentDiv.querySelector('.bfs_bf_item_buyBtn') : null;

                if(bundle_variants[parentDiv.getAttribute('id')]) 
                {
                    if(variantId = bundle_variants[parentDiv.getAttribute('id')][this.value])
                    {
                        //console.log('variantTitle [' + this.value + '] variantId [' + variantId + ']');

                        if (button) {
                            button.setAttribute('data-ajax-cart-request-button', `/cart/add?id=${variantId}&quantity=1`);
                        }
                    }
                }

            });
        });


        document.querySelectorAll('.form-select').forEach(select => {
            select.addEventListener('change', function() {
                let variantId = 0;
                let variantTitle = '';
                const parentDiv = this.closest('.bfs_bf_item');
                const button = parentDiv ? parentDiv.querySelector('.bfs_bf_item_buyBtn') : null;
                const select_first = parentDiv ? parentDiv.querySelector('.form-select-first') : null;
                const select_second = parentDiv ? parentDiv.querySelector('.form-select-second') : null;

                if(select_first && select_second)
                {
                    variantTitle = select_first.options[select_first.selectedIndex].text + ' / ' + select_second.options[select_second.selectedIndex].text;
                }

                if(variantTitle == '')
                {
                    variantTitle = this.options[this.selectedIndex].text;
                }
                
                if(bundle_variants[parentDiv.getAttribute('id')]) 
                {
                    if(variantId = bundle_variants[parentDiv.getAttribute('id')][variantTitle])
                    {
                        //console.log('variantTitle [' + variantTitle + '] variantId [' + variantId + ']');

                        if (button) {
                            button.setAttribute('data-ajax-cart-request-button', `/cart/add?id=${variantId}&quantity=1`);
                        }
                    }
                }
            });
        });
    });
</script>

{% schema %}
    {
        "name": "t:sections.exclusive-holiday-bundle-deal-bundles-header.name",
        "class": "section-exclusive-holiday-bundle-deal-bundles-header",
        "settings": [
            {
                "type": "text",
                "id": "heading",
                "label": "t:common.heading.label"
            },
            {
                "type": "text",
                "id": "subheading",
                "label": "t:common.subheading.label"
            },
            {
                "type": "richtext",
                "id": "text",
                "label": "t:common.text.label"
            }
        ],
        "blocks": [
            {
                "type": "badge",
                "name": "t:common.badge.label",
                "limit": 1,
                "settings": [
                    {
                        "type": "text",
                        "id": "heading",
                        "label": "t:common.heading.label",
                        "default": "BLACK FRIDAY"
                    },
                    {
                        "type": "text",
                        "id": "text",
                        "label": "t:common.text.label",
                        "default": "SALE"
                    },
                    {
                        "type":"color",
                        "id":"color",
                        "label":"t:common.color.label",
                        "default":"#C4121A"
                    }
                ]
            },
            {
                "type": "object",
                "name": "t:common.object.label",
                "settings": [
                    {
                        "type": "richtext",
                        "id": "text",
                        "label": "t:common.heading.label"
                    },
                    {
                        "type": "image_picker",
                        "id": "image",
                        "label": "t:common.image.label"
                    },
                    {
                        "type": "url",
                        "id": "link_url",
                        "label": "t:common.link.url.label"
                    }
                ]
		    }
        ]
    }
{% endschema %}